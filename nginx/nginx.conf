#sends events to the rasa container on port 5005
upstream medchatboten {
    server medchatbot-english:5005;
}

upstream medchatbothi {
    server medchatbot-hindi:5005;
}

upstream medchatbotmr {
    server medchatbot-marathi:5005;
}

upstream medchatbotta {
    server medchatbot-tamil:5005;
}
upstream medchatbotte {
    server medchatbot-telugu:5005;
}
upstream medchatbotbn
{
    server medchatbot-bengali:5005;
}
upstream medchatbotkn
{
    server medchatbot-kannad:5005;
}



server {
    listen       80;
    server_name  localhost;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatboten;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}



server {
    listen       80;
    server_name  hindi.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbothi;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

server {
    listen       80;
    server_name  marathi.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbotmr;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

server {
    listen       80;
    server_name  tamil.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbotta;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

server {
    listen       80;
    server_name  telugu.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbotte;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

server {
    listen       80;
    server_name  bengali.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbotbn;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}

server {
    listen       80;
    server_name  kannad.medchatbot;

#reverse proxy to rasa container
    location / {
        proxy_pass  http://medchatbotkn;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;                                                      
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}


#comment out this block if you are testing locally 
#listen to port 443 (default port for encrypted messages)
# server {
#       listen 443 ssl;
#       server_name aman.today;

#   #points to ssl certificates that we will move to nginx docker container in docker compose
#       ssl_certificate /etc/letsencrypt/live/bot.mavoix.in/fullchain.pem;
#       ssl_certificate_key /etc/letsencrypt/live/bot.mavoix.in/privkey.pem;
#       ssl_trusted_certificate /etc/letsencrypt/live/bot.mavoix.in/fullchain.pem;

#   #reverse proxy to rasa container
#       location / {
#           proxy_pass  http://rasa;
#       }
# }


#comment out this block if you are testing locally 
#listen to port 443 (default port for encrypted messages)


### commented to test it locally :) Infinity Voborics
# server {
#       listen 443 ssl;
#       server_name aman.today;

#   #points to ssl certificates that we will move to nginx docker container in docker compose
#       ssl_certificate /etc/letsencrypt/live/aman.today/fullchain.pem;
#       ssl_certificate_key /etc/letsencrypt/live/aman.today/private-key.pem;
#       ssl_trusted_certificate /etc/letsencrypt/live/aman.today/fullchain.pem;

#   #reverse proxy to rasa container
#       location / {
#           proxy_pass  http://rasai;
#           proxy_http_version 1.1;
#           proxy_set_header Upgrade $http_upgrade;                                                      
#           proxy_set_header Connection "upgrade";
#           proxy_set_header Host $host;
#       }
# }

### commented out for local testing infinity voborics


# server {
#       listen 443 ssl;
#       server_name medulla.aman.today;

#   #points to ssl certificates that we will move to nginx docker container in docker compose
#       ssl_certificate /etc/letsencrypt/live/medulla.aman.today/fullchain.pem;
#       ssl_certificate_key /etc/letsencrypt/live/medulla.aman.today/private-key.pem;
#       ssl_trusted_certificate /etc/letsencrypt/live/medulla.aman.today/fullchain.pem;

#   #reverse proxy to rasa container
#       location / {
#           proxy_pass  http://rasao;
#           proxy_http_version 1.1;
#           proxy_set_header Upgrade $http_upgrade;                                                      
#           proxy_set_header Connection "upgrade";
#           proxy_set_header Host $host;
#       }
# }